<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="First Last">
<meta name="dcterms.date" content="2025-09-27">

<title>NHANES Data: Investigating Relationship Between Lead Exposure and High Blood Pressure – sofiyavyshnya</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-dfb324f25d9b1687192fa8be62ac8f9c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<!-- Load Academicons for CV, Google Scholar, ORCID -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons/css/academicons.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">


<link rel="stylesheet" href="styles.css">
</head>

<body class="floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">sofiyavyshnya</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./research.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./contact.html"> 
<span class="menu-text">Contact</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#central-hypothesis" id="toc-central-hypothesis" class="nav-link active" data-scroll-target="#central-hypothesis"><span class="header-section-number">1</span> Central Hypothesis</a></li>
  <li><a href="#setup-and-data-ingest" id="toc-setup-and-data-ingest" class="nav-link" data-scroll-target="#setup-and-data-ingest"><span class="header-section-number">2</span> Setup and Data Ingest</a></li>
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning"><span class="header-section-number">3</span> Data Cleaning</a>
  <ul class="collapse">
  <li><a href="#data-imputation" id="toc-data-imputation" class="nav-link" data-scroll-target="#data-imputation"><span class="header-section-number">3.1</span> Data Imputation</a>
  <ul class="collapse">
  <li><a href="#demonstration-of-missing-data-investigating-patterns-of-data-missingness-mcar-mar-nmar" id="toc-demonstration-of-missing-data-investigating-patterns-of-data-missingness-mcar-mar-nmar" class="nav-link" data-scroll-target="#demonstration-of-missing-data-investigating-patterns-of-data-missingness-mcar-mar-nmar"><span class="header-section-number">3.1.1</span> Demonstration of Missing Data &amp; Investigating Patterns of Data Missingness (MCAR, MAR, NMAR)</a></li>
  <li><a href="#imputation-method-mice-based-on-desired-model-that-uses-heavy-metal-concentrations-in-the-blood-raceethnicity-sex-to-predict-systolic-blood-pressure" id="toc-imputation-method-mice-based-on-desired-model-that-uses-heavy-metal-concentrations-in-the-blood-raceethnicity-sex-to-predict-systolic-blood-pressure" class="nav-link" data-scroll-target="#imputation-method-mice-based-on-desired-model-that-uses-heavy-metal-concentrations-in-the-blood-raceethnicity-sex-to-predict-systolic-blood-pressure"><span class="header-section-number">3.1.2</span> Imputation Method: MICE (Based on Desired Model that uses heavy metal concentrations in the blood + race/ethnicity + sex to predict systolic blood pressure)</a></li>
  </ul></li>
  <li><a href="#outlier-removal" id="toc-outlier-removal" class="nav-link" data-scroll-target="#outlier-removal"><span class="header-section-number">3.2</span> Outlier Removal</a></li>
  </ul></li>
  <li><a href="#dataset-description-and-codebook" id="toc-dataset-description-and-codebook" class="nav-link" data-scroll-target="#dataset-description-and-codebook"><span class="header-section-number">4</span> Dataset Description and Codebook</a>
  <ul class="collapse">
  <li><a href="#final-dataset-description-summary-statistics" id="toc-final-dataset-description-summary-statistics" class="nav-link" data-scroll-target="#final-dataset-description-summary-statistics"><span class="header-section-number">4.1</span> [Final] Dataset Description &amp; Summary Statistics</a></li>
  <li><a href="#codebook-html-rendering" id="toc-codebook-html-rendering" class="nav-link" data-scroll-target="#codebook-html-rendering"><span class="header-section-number">4.2</span> Codebook (HTML Rendering)</a></li>
  <li><a href="#codebook-table-rendering" id="toc-codebook-table-rendering" class="nav-link" data-scroll-target="#codebook-table-rendering"><span class="header-section-number">4.3</span> Codebook (Table Rendering)</a></li>
  <li><a href="#analytic-tibble" id="toc-analytic-tibble" class="nav-link" data-scroll-target="#analytic-tibble"><span class="header-section-number">4.4</span> Analytic Tibble</a></li>
  </ul></li>
  <li><a href="#summary-statistics" id="toc-summary-statistics" class="nav-link" data-scroll-target="#summary-statistics"><span class="header-section-number">5</span> Summary Statistics</a></li>
  <li><a href="#my-research-question" id="toc-my-research-question" class="nav-link" data-scroll-target="#my-research-question"><span class="header-section-number">6</span> My Research Question</a></li>
  <li><a href="#partitioning-the-data" id="toc-partitioning-the-data" class="nav-link" data-scroll-target="#partitioning-the-data"><span class="header-section-number">7</span> Partitioning the Data</a></li>
  <li><a href="#transforming-the-outcome" id="toc-transforming-the-outcome" class="nav-link" data-scroll-target="#transforming-the-outcome"><span class="header-section-number">8</span> Transforming the Outcome</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">NHANES Data: Investigating Relationship Between Lead Exposure and High Blood Pressure</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">First Last </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Your Institution
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2025-09-27</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="central-hypothesis" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Central Hypothesis</h1>
<p>My central hypothesis for this study is that middle-aged adults (age 40-65) adults with heavy metal exposure (e.g.&nbsp;lead exposure) have higher systolic blood pressure. To test this hypothesis, I am using data gathered from NHANES during the years of 2017-March 2020 (the pre-pandemic years). In this study (Study 2 analyses), I am modeling the relationship between the concentration of lead in the blood and blood pressure.</p>
</section>
<section id="setup-and-data-ingest" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Setup and Data Ingest</h1>
<p>The dataset consists of 2475 adults ages 40-65 participating in NHANES 2017-2020. The original NHANES data from 2017-2020 contained 9254 observations collected from individuals age 0-80. However, after selecting individuals aged 40-65, 2475 individuals were left.</p>
</section>
<section id="data-cleaning" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Data Cleaning</h1>
<p>Outliers (defined as values &lt; Q1- 1.5<em>IQR or &gt; Q3+1.5</em>IQR) were removed. Data were imputed using MICE. The resulting dataset has 2475 observations.</p>
<section id="data-imputation" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="data-imputation"><span class="header-section-number">3.1</span> Data Imputation</h2>
<section id="demonstration-of-missing-data-investigating-patterns-of-data-missingness-mcar-mar-nmar" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="demonstration-of-missing-data-investigating-patterns-of-data-missingness-mcar-mar-nmar"><span class="header-section-number">3.1.1</span> Demonstration of Missing Data &amp; Investigating Patterns of Data Missingness (MCAR, MAR, NMAR)</h3>
<p>First, I want to find out any patterns in my missing values to understand whether the data is missing completely at random (MCAR), missing at random (MAR), or missing not at random (MNAR).</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="nhanes_bp_leadExposure_files/figure-html/unnamed-chunk-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="nhanes_bp_leadExposure_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 3
  variable n_miss pct_miss
  &lt;chr&gt;     &lt;int&gt;    &lt;num&gt;
1 BPXSY1      378    15.3 
2 BPXDI1      378    15.3 
3 LBXBPB      197     7.96
4 LBXBCD      197     7.96
5 LBXBMN      197     7.96
6 SEQN          0     0   
7 RIDAGEYR      0     0   
8 RIAGENDR      0     0   
9 RIDRETH1      0     0   </code></pre>
</div>
</div>
<p>The data is not missing completely at random. Missingness is observed in blocks/clusters: one cluster is for lab values (LBXBPB, LBXBCD, LBXBMN) and another is for blood pressure readings (BPXSY1, BPXDI1). Individuals who are missing one lab value are also going to be missing the others. Likewise, individuals who are missing one blood pressure reading will also be missing the others. Furthermore, it’s possible that individuals missing lab values are also more likely to have blood pressure readings missing. To investigate this, I will use a Chi square test to see if there is any dependency in the missingness of lab values and blood pressure:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   
       0    1
  0 2015  263
  1   82  115</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  tab
X-squared = 303.69, df = 1, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Cramer V 
  0.3524 </code></pre>
</div>
</div>
<p>The significant test result and moderate effect size suggests some dependency: individuals missing lab values are also somewhat more likely to have BP values missing (or vice versa?).</p>
<p>Next, I want to check if the missingness is associated with observed covariates. This makes it more likely that the missing values are MAR.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = lab_missing ~ RIDAGEYR + RIAGENDR + RIDRETH1, family = binomial, 
    data = nhanes_filtered)

Coefficients:
                            Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)                -1.496040   0.564560  -2.650  0.00805 **
RIDAGEYR                   -0.022070   0.009855  -2.239  0.02513 * 
RIAGENDRFemale             -0.137618   0.149291  -0.922  0.35663   
RIDRETH1Other Hispanic     -0.649419   0.421871  -1.539  0.12371   
RIDRETH1Non-Hispanic White  0.234973   0.262735   0.894  0.37114   
RIDRETH1Non-Hispanic Black  0.579121   0.257134   2.252  0.02431 * 
RIDRETH1Other/Multiracial   0.428955   0.265799   1.614  0.10656   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1375.0  on 2474  degrees of freedom
Residual deviance: 1352.3  on 2468  degrees of freedom
AIC: 1366.3

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = bp_missing ~ RIDAGEYR + RIAGENDR + RIDRETH1, family = binomial, 
    data = nhanes_filtered)

Coefficients:
                            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                -1.656627   0.427797  -3.872 0.000108 ***
RIDAGEYR                   -0.004570   0.007429  -0.615 0.538452    
RIAGENDRFemale              0.141990   0.112422   1.263 0.206587    
RIDRETH1Other Hispanic      0.132636   0.231888   0.572 0.567332    
RIDRETH1Non-Hispanic White  0.029522   0.187244   0.158 0.874719    
RIDRETH1Non-Hispanic Black  0.280575   0.185378   1.514 0.130146    
RIDRETH1Other/Multiracial   0.070331   0.194831   0.361 0.718109    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2115.7  on 2474  degrees of freedom
Residual deviance: 2110.0  on 2468  degrees of freedom
AIC: 2124

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p>From the regression otput, it appears that missingness in lab values is related to observed covariates in the dataset – certain sexes and races are more likely to have data missing. Therefore, I can plausibly assume that the data is missing at random (MAR). However, for blood pressure values, that does not seem to be the case. It is therefore possible that missingness is driven by some unobserved variable and BP values could be NMAR. However, for the purposes of this assignment, <em>I will assume that all data is MAR</em>. Thus, standard imputation methods like multiple imputation (MICE) are appropriate.</p>
</section>
<section id="imputation-method-mice-based-on-desired-model-that-uses-heavy-metal-concentrations-in-the-blood-raceethnicity-sex-to-predict-systolic-blood-pressure" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="imputation-method-mice-based-on-desired-model-that-uses-heavy-metal-concentrations-in-the-blood-raceethnicity-sex-to-predict-systolic-blood-pressure"><span class="header-section-number">3.1.2</span> Imputation Method: MICE (Based on Desired Model that uses heavy metal concentrations in the blood + race/ethnicity + sex to predict systolic blood pressure)</h3>
<p>I used predictive mean matching (PMM) for continuous variables. The categorical variables in the dataset (sex, race/ethnicity) had no missing values according to the heatmap in the section “Demonstration of Missing Data &amp; Investigating Patterns of Data Missingness (MCAR, MAR, NMAR)”. Only predictor variables were imputed; the outcome variable, systolic blood pressure (BPXSY1), was not imputed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Impute filtered dataset </span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define methods per variable</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>meth <span class="ot">&lt;-</span> <span class="fu">make.method</span>(nhanes_filtered)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>meth[<span class="fu">c</span>(<span class="st">"LBXBPB"</span>, <span class="st">"LBXBCD"</span>, <span class="st">"LBXBMN"</span>)] <span class="ot">&lt;-</span> <span class="st">"pmm"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>meth[<span class="st">"SEQN"</span>] <span class="ot">&lt;-</span> <span class="st">""</span>  <span class="co"># ID variable excluded</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform imputation</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> <span class="fu">mice</span>(</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  nhanes_filtered,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">m =</span> <span class="dv">1</span>,       <span class="co"># single imputed dataset</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> meth,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">maxit =</span> <span class="dv">20</span>,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">printFlag =</span> <span class="cn">FALSE</span>    <span class="co"># &lt;-- suppress iteration output</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Complete data after imputation</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>nhanes_imputed <span class="ot">&lt;-</span> <span class="fu">complete</span>(imp, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>       SEQN    RIDAGEYR    RIAGENDR    RIDRETH1      LBXBPB      LBXBCD 
          0           0           0           0           0           0 
     LBXBMN      BPXSY1      BPXDI1 lab_missing  bp_missing 
          0           0           0           0           0 </code></pre>
</div>
</div>
<p>The only missing values should be in the outcome variable, not the predictor variables.</p>
</section>
</section>
<section id="outlier-removal" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="outlier-removal"><span class="header-section-number">3.2</span> Outlier Removal</h2>
<p>An alternative strategy would be to impute outliers instead of simply dropping them.</p>
<p>Check data distributions before and after dropping outliers</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="nhanes_bp_leadExposure_files/figure-html/unnamed-chunk-8-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="nhanes_bp_leadExposure_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="dataset-description-and-codebook" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Dataset Description and Codebook</h1>
<section id="final-dataset-description-summary-statistics" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="final-dataset-description-summary-statistics"><span class="header-section-number">4.1</span> [Final] Dataset Description &amp; Summary Statistics</h2>
<p>Table 1: Variables included in the data.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Data Type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>SEQN</strong></td>
<td style="text-align: left;">Subject ID: Individual Identifier</td>
<td style="text-align: left;">Quantitative (Integer)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>RIDAGEYR</strong></td>
<td style="text-align: left;">Age: Age in years at screening, range 40-65</td>
<td style="text-align: left;">Quantitative (Integer)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>RIAGENDR</strong></td>
<td style="text-align: left;">Sex: male or female</td>
<td style="text-align: left;">Binary</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>RIDRETH1</strong></td>
<td style="text-align: left;">Race</td>
<td style="text-align: left;">Multi-level Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>LBXBPB</strong></td>
<td style="text-align: left;">Blood lead (µg/dL)</td>
<td style="text-align: left;">Quantitative (Continuous)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>LBXBPB_clean</strong></td>
<td style="text-align: left;"><strong>Key Predictor</strong>: Blood lead after outlier removal</td>
<td style="text-align: left;">Quantitative (Continuous)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>LBXBCD</strong></td>
<td style="text-align: left;">Blood cadmium (µg/dL)</td>
<td style="text-align: left;">Quantitative (Continuous)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>LBXBCD_clean</strong></td>
<td style="text-align: left;"><strong>Key Predictor</strong>: Blood cadmium (µg/dL) after outlier removal</td>
<td style="text-align: left;">Quantitative (Continuous)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>LBXBMN</strong></td>
<td style="text-align: left;">Blood manganese (µg/dL)</td>
<td style="text-align: left;">Quantitative (Continuous)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>LBXBMN_clean</strong></td>
<td style="text-align: left;"><strong>Key Predictor</strong>: Blood manganese (µg/dL) after outlier removal</td>
<td style="text-align: left;">Quantitative (Continuous)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>BPXSY1</strong></td>
<td style="text-align: left;">Systolic BP, first reading</td>
<td style="text-align: left;">Quantitative (Integer)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>BPXSY1_clean</strong></td>
<td style="text-align: left;"><strong>Outcome</strong>: Systolic BP, first reading, after outlier removal</td>
<td style="text-align: left;">Quantitative (Integer)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>BPXDI1</strong></td>
<td style="text-align: left;">Diastolic BP, first reading</td>
<td style="text-align: left;">Quantitative (Integer)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>BPXDI1_clean</strong></td>
<td style="text-align: left;">Diastolic BP, first reading, after outlier removal</td>
<td style="text-align: left;">Quantitative (Integer)</td>
</tr>
</tbody>
</table>
<p>Summary statistics for the continuous and categorical variables:</p>
<p>Table 2: Summary of numeric data.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">mean</th>
<th style="text-align: left;">stdev</th>
<th style="text-align: left;">median</th>
<th style="text-align: left;">min</th>
<th style="text-align: left;">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>RIDAGEYR</strong></td>
<td style="text-align: left;">53.46</td>
<td style="text-align: left;">7.59</td>
<td style="text-align: left;">54.00</td>
<td style="text-align: left;">40.00</td>
<td style="text-align: left;">65.00</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>LBXBPB</strong></td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">0.54</td>
<td style="text-align: left;">0.94</td>
<td style="text-align: left;">0.12</td>
<td style="text-align: left;">2.79</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>LBXBCD</strong></td>
<td style="text-align: left;">0.37</td>
<td style="text-align: left;">0.25</td>
<td style="text-align: left;">0.30</td>
<td style="text-align: left;">0.07</td>
<td style="text-align: left;">1.21</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>LBXBMN</strong></td>
<td style="text-align: left;">9.67</td>
<td style="text-align: left;">3.01</td>
<td style="text-align: left;">9.32</td>
<td style="text-align: left;">3.07</td>
<td style="text-align: left;">18.34</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>BPXSY1</strong></td>
<td style="text-align: left;">126.68</td>
<td style="text-align: left;">16.01</td>
<td style="text-align: left;">126.00</td>
<td style="text-align: left;">88.00</td>
<td style="text-align: left;">170.00</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>BPXDI1</strong></td>
<td style="text-align: left;">76.17</td>
<td style="text-align: left;">10.02</td>
<td style="text-align: left;">76.00</td>
<td style="text-align: left;">50.00</td>
<td style="text-align: left;">104.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>LBXBPB_clean</strong></td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">0.54</td>
<td style="text-align: left;">0.94</td>
<td style="text-align: left;">0.11</td>
<td style="text-align: left;">0.12</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>LBXBCD_clean</strong></td>
<td style="text-align: left;">0.37</td>
<td style="text-align: left;">0.25</td>
<td style="text-align: left;">0.30</td>
<td style="text-align: left;">0.07</td>
<td style="text-align: left;">0.07</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>LBXBMN_clean</strong></td>
<td style="text-align: left;">9.67</td>
<td style="text-align: left;">3.01</td>
<td style="text-align: left;">9.32</td>
<td style="text-align: left;">1.40</td>
<td style="text-align: left;">3.07</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>BPXSY1_clean</strong></td>
<td style="text-align: left;">126.68</td>
<td style="text-align: left;">16.01</td>
<td style="text-align: left;">126.00</td>
<td style="text-align: left;">88.00</td>
<td style="text-align: left;">170.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>BPXDI1_clean</strong></td>
<td style="text-align: left;">76.17</td>
<td style="text-align: left;">10.02</td>
<td style="text-align: left;">76.00</td>
<td style="text-align: left;">50.00</td>
<td style="text-align: left;">104.00</td>
</tr>
</tbody>
</table>
<p>Table 3: Summary of categorical data.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Count (Percent)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>RIAGENDR: Sex</strong></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Male</td>
<td style="text-align: left;">943 (47.99%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Female</td>
<td style="text-align: left;">1022 (52.01%)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>RIDRETH1: Race</strong></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mexican American</td>
<td style="text-align: left;">294 (14.96%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other Hispanic</td>
<td style="text-align: left;">218 (11.09%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Non-Hispanic White</td>
<td style="text-align: left;">559 (28.44%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Non-Hispanic Black</td>
<td style="text-align: left;">489 (24.88%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other Race - Including Multi-Racial</td>
<td style="text-align: left;">405 (20.61%)</td>
</tr>
</tbody>
</table>
</section>
<section id="codebook-html-rendering" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="codebook-html-rendering"><span class="header-section-number">4.2</span> Codebook (HTML Rendering)</h2>
</section>
<section id="codebook-table-rendering" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="codebook-table-rendering"><span class="header-section-number">4.3</span> Codebook (Table Rendering)</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 9
   variable     type    missing      min      q25  median    mean     q75    max
   &lt;chr&gt;        &lt;chr&gt;     &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
 1 SEQN         numeric       0 93711    95997    9.83e+4 9.83e+4 1.01e+5 1.03e5
 2 RIDAGEYR     numeric       0    40       47    5.4 e+1 5.35e+1 6   e+1 6.5 e1
 3 LBXBPB       numeric       0     0.12     0.61 9.4 e-1 1.04e+0 1.33e+0 2.79e0
 4 LBXBCD       numeric       0     0.07     0.18 3   e-1 3.72e-1 4.8 e-1 1.21e0
 5 LBXBMN       numeric       0     3.07     7.46 9.32e+0 9.67e+0 1.15e+1 1.83e1
 6 BPXSY1       numeric       0    88      116    1.26e+2 1.27e+2 1.38e+2 1.7 e2
 7 BPXDI1       numeric       0    50       70    7.6 e+1 7.62e+1 8.2 e+1 1.04e2
 8 lab_missing  integer       0     0        0    0       7.33e-2 0       1   e0
 9 bp_missing   integer       0     0        0    0       1.54e-1 0       1   e0
10 LBXBPB_clean numeric       0     0.12     0.61 9.4 e-1 1.04e+0 1.33e+0 2.79e0
11 LBXBCD_clean numeric       0     0.07     0.18 3   e-1 3.72e-1 4.8 e-1 1.21e0
12 LBXBMN_clean numeric       0     3.07     7.46 9.32e+0 9.67e+0 1.15e+1 1.83e1
13 BPXSY1_clean numeric       0    88      116    1.26e+2 1.27e+2 1.38e+2 1.7 e2
14 BPXDI1_clean numeric       0    50       70    7.6 e+1 7.62e+1 8.2 e+1 1.04e2</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  variable type   missing n_unique levels                                       
  &lt;chr&gt;    &lt;chr&gt;    &lt;int&gt;    &lt;int&gt; &lt;chr&gt;                                        
1 RIAGENDR factor       0        2 Male, Female                                 
2 RIDRETH1 factor       0        5 Other/Multiracial, Non-Hispanic Black, Mexic…</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 4
  variable level              count missing
  &lt;chr&gt;    &lt;fct&gt;              &lt;int&gt;   &lt;int&gt;
1 RIAGENDR Male                 943       0
2 RIAGENDR Female              1022       0
3 RIDRETH1 Mexican American     294       0
4 RIDRETH1 Other Hispanic       218       0
5 RIDRETH1 Non-Hispanic White   559       0
6 RIDRETH1 Non-Hispanic Black   489       0
7 RIDRETH1 Other/Multiracial    405       0</code></pre>
</div>
</div>
</section>
<section id="analytic-tibble" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="analytic-tibble"><span class="header-section-number">4.4</span> Analytic Tibble</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   SEQN RIDAGEYR RIAGENDR           RIDRETH1 LBXBPB LBXBCD LBXBMN BPXSY1 BPXDI1
1 93711       56     Male  Other/Multiracial   2.15   0.38   6.55    108     68
2 93714       54   Female Non-Hispanic Black   0.71   0.31   7.85    126     76
3 93716       61     Male  Other/Multiracial   1.99   0.23   8.80    120     72
4 93718       45     Male Non-Hispanic Black   0.62   0.10  12.00    128     88
5 93721       60   Female   Mexican American   0.75   0.18   9.92    132     68
6 93722       60   Female Non-Hispanic White   0.98   0.38  15.05    116     68
  lab_missing bp_missing LBXBPB_clean LBXBCD_clean LBXBMN_clean BPXSY1_clean
1           0          0         2.15         0.38         6.55          108
2           0          1         0.71         0.31         7.85          126
3           0          0         1.99         0.23         8.80          120
4           0          0         0.62         0.10        12.00          128
5           0          0         0.75         0.18         9.92          132
6           0          0         0.98         0.38        15.05          116
  BPXDI1_clean
1           68
2           76
3           72
4           88
5           68
6           68</code></pre>
</div>
</div>
</section>
</section>
<section id="summary-statistics" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Summary Statistics</h1>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>             vars    n     mean      sd   median  trimmed     mad      min
SEQN            1 1965 98330.19 2706.83 98334.00 98325.70 3435.18 93711.00
RIDAGEYR        2 1965    53.46    7.59    54.00    53.69   10.38    40.00
RIAGENDR*       3 1965     1.52    0.50     2.00     1.53    0.00     1.00
RIDRETH1*       4 1965     3.25    1.31     3.00     3.31    1.48     1.00
LBXBPB          5 1965     1.04    0.54     0.94     0.98    0.52     0.12
LBXBCD          6 1965     0.37    0.25     0.30     0.34    0.21     0.07
LBXBMN          7 1965     9.67    3.01     9.32     9.50    2.98     3.07
BPXSY1          8 1965   126.68   16.01   126.00   126.09   14.83    88.00
BPXDI1          9 1965    76.17   10.02    76.00    76.07    8.90    50.00
lab_missing    10 1965     0.07    0.26     0.00     0.00    0.00     0.00
bp_missing     11 1965     0.15    0.36     0.00     0.07    0.00     0.00
LBXBPB_clean   12 1965     1.04    0.54     0.94     0.98    0.52     0.12
LBXBCD_clean   13 1965     0.37    0.25     0.30     0.34    0.21     0.07
LBXBMN_clean   14 1965     9.67    3.01     9.32     9.50    2.98     3.07
BPXSY1_clean   15 1965   126.68   16.01   126.00   126.09   14.83    88.00
BPXDI1_clean   16 1965    76.17   10.02    76.00    76.07    8.90    50.00
                   max   range  skew kurtosis    se
SEQN         102954.00 9243.00  0.01    -1.20 61.06
RIDAGEYR         65.00   25.00 -0.20    -1.23  0.17
RIAGENDR*         2.00    1.00 -0.08    -1.99  0.01
RIDRETH1*         5.00    4.00 -0.32    -0.93  0.03
LBXBPB            2.79    2.67  0.88     0.38  0.01
LBXBCD            1.21    1.14  1.21     0.90  0.01
LBXBMN           18.34   15.27  0.49    -0.17  0.07
BPXSY1          170.00   82.00  0.32    -0.24  0.36
BPXDI1          104.00   54.00  0.09    -0.09  0.23
lab_missing       1.00    1.00  3.27     8.71  0.01
bp_missing        1.00    1.00  1.92     1.68  0.01
LBXBPB_clean      2.79    2.67  0.88     0.38  0.01
LBXBCD_clean      1.21    1.14  1.21     0.90  0.01
LBXBMN_clean     18.34   15.27  0.49    -0.17  0.07
BPXSY1_clean    170.00   82.00  0.32    -0.24  0.36
BPXDI1_clean    104.00   54.00  0.09    -0.09  0.23</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  variable              level    n Proportion
1 RIAGENDR               Male  943  0.4798982
2 RIAGENDR             Female 1022  0.5201018
3 RIDRETH1   Mexican American  294  0.1496183
4 RIDRETH1     Other Hispanic  218  0.1109415
5 RIDRETH1 Non-Hispanic White  559  0.2844784
6 RIDRETH1 Non-Hispanic Black  489  0.2488550
7 RIDRETH1  Other/Multiracial  405  0.2061069</code></pre>
</div>
</div>
</section>
<section id="my-research-question" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> My Research Question</h1>
<p><em>How does blood pressure vary with concentration of heavy metals in the blood?</em> I know that heavy metals can lead to inflammation, which can affect cardiovascular health. My hypothesis is that blood pressure has a positive relationship with heavy metal concentrations in the blood. In Study 1, I learned that blood pressure is also influenced by sex (to a small degree) and by race/ethnicity (to a larger degree), so I will control for these demographic variables.</p>
</section>
<section id="partitioning-the-data" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Partitioning the Data</h1>
</section>
<section id="transforming-the-outcome" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Transforming the Outcome</h1>
<p>I did not transform the outcome variable because it already follows an approximately Gaussian distribution.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BPXSY1_clean ~ LBXBPB_clean + LBXBCD_clean + LBXBMN_clean + 
    RIDAGEYR + RIAGENDR + RIDRETH1, data = nhanes_clean)

Residuals:
    Min      1Q  Median      3Q     Max 
-40.901 -10.709  -0.476   9.699  45.841 

Coefficients:
                           Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                93.96858    2.93515  32.015  &lt; 2e-16 ***
LBXBPB_clean               -0.16980    0.67843  -0.250 0.802390    
LBXBCD_clean                0.96876    1.41384   0.685 0.493301    
LBXBMN_clean                0.20039    0.12207   1.642 0.100826    
RIDAGEYR                    0.59451    0.04667  12.738  &lt; 2e-16 ***
RIAGENDRFemale             -2.59212    0.71189  -3.641 0.000278 ***
RIDRETH1Other Hispanic     -1.32760    1.35116  -0.983 0.325946    
RIDRETH1Non-Hispanic White -2.80198    1.09572  -2.557 0.010627 *  
RIDRETH1Non-Hispanic Black  5.32955    1.13397   4.700 2.78e-06 ***
RIDRETH1Other/Multiracial  -1.12596    1.18692  -0.949 0.342920    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 15.04 on 1955 degrees of freedom
Multiple R-squared:  0.1215,    Adjusted R-squared:  0.1175 
F-statistic: 30.05 on 9 and 1955 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="nhanes_bp_leadExposure_files/figure-html/unnamed-chunk-17-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="nhanes_bp_leadExposure_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>