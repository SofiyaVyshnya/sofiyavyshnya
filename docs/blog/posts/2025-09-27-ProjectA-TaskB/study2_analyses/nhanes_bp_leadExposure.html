<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sofiya Vyshnya">
<meta name="dcterms.date" content="2025-09-28">

<title>Blood Pressure Determinants: Investigating Relationship Between Lead Exposure and High Blood Pressure – sofiyavyshnya</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../">
<script src="../../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../site_libs/bootstrap/bootstrap-e31584831b205ffbb2d98406f31c2a5b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../../../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../../../../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="../../../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="../../../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="../../../../site_libs/datatables-binding-0.34.0/datatables.js"></script>

<script src="../../../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="../../../../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="../../../../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="../../../../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<link href="../../../../site_libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">

<script src="../../../../site_libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>

<!-- Load Academicons for CV, Google Scholar, ORCID -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons/css/academicons.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../../styles.css">
</head>

<body class="floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../../../../index.html">
    <span class="navbar-title">sofiyavyshnya</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../research.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-dashboard" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Dashboard</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-dashboard">    
        <li>
    <a class="dropdown-item" href="../../../../dashboard/dashboard.html">
 <span class="dropdown-text">Dashboard</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../blog/posts/2025-09-27-ProjectA-TaskB/study1_analyses/nhanes_data_exploration.html">
 <span class="dropdown-text">Data Exploration (Study 1)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../blog/posts/2025-09-27-ProjectA-TaskB/study2_analyses/nhanes_bp_leadExposure.html">
 <span class="dropdown-text">BP Determinants (Study 2)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../../contact.html"> 
<span class="menu-text">Contact</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#central-hypothesis" id="toc-central-hypothesis" class="nav-link active" data-scroll-target="#central-hypothesis"><span class="header-section-number">1</span> Central Hypothesis</a></li>
  <li><a href="#import-helper-functions" id="toc-import-helper-functions" class="nav-link" data-scroll-target="#import-helper-functions"><span class="header-section-number">2</span> Import Helper Functions</a></li>
  <li><a href="#setup-and-data-ingest" id="toc-setup-and-data-ingest" class="nav-link" data-scroll-target="#setup-and-data-ingest"><span class="header-section-number">3</span> Setup and Data Ingest</a></li>
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning"><span class="header-section-number">4</span> Data Cleaning</a>
  <ul class="collapse">
  <li><a href="#data-imputation" id="toc-data-imputation" class="nav-link" data-scroll-target="#data-imputation"><span class="header-section-number">4.1</span> Data Imputation</a>
  <ul class="collapse">
  <li><a href="#demonstration-of-missing-data-investigating-patterns-of-data-missingness-mcar-mar-nmar" id="toc-demonstration-of-missing-data-investigating-patterns-of-data-missingness-mcar-mar-nmar" class="nav-link" data-scroll-target="#demonstration-of-missing-data-investigating-patterns-of-data-missingness-mcar-mar-nmar"><span class="header-section-number">4.1.1</span> Demonstration of Missing Data &amp; Investigating Patterns of Data Missingness (MCAR, MAR, NMAR)</a></li>
  <li><a href="#imputation-method-mice-based-on-desired-model-that-uses-heavy-metal-concentrations-in-the-blood-raceethnicity-sex-to-predict-systolic-blood-pressure" id="toc-imputation-method-mice-based-on-desired-model-that-uses-heavy-metal-concentrations-in-the-blood-raceethnicity-sex-to-predict-systolic-blood-pressure" class="nav-link" data-scroll-target="#imputation-method-mice-based-on-desired-model-that-uses-heavy-metal-concentrations-in-the-blood-raceethnicity-sex-to-predict-systolic-blood-pressure"><span class="header-section-number">4.1.2</span> Imputation Method: MICE (Based on Desired Model that uses heavy metal concentrations in the blood + race/ethnicity + sex to predict systolic blood pressure)</a></li>
  </ul></li>
  <li><a href="#outlier-removal" id="toc-outlier-removal" class="nav-link" data-scroll-target="#outlier-removal"><span class="header-section-number">4.2</span> Outlier Removal</a></li>
  </ul></li>
  <li><a href="#dataset-description-and-codebook" id="toc-dataset-description-and-codebook" class="nav-link" data-scroll-target="#dataset-description-and-codebook"><span class="header-section-number">5</span> Dataset Description and Codebook</a>
  <ul class="collapse">
  <li><a href="#dataset-description-summary-statistics" id="toc-dataset-description-summary-statistics" class="nav-link" data-scroll-target="#dataset-description-summary-statistics"><span class="header-section-number">5.1</span> Dataset Description &amp; Summary Statistics</a></li>
  <li><a href="#codebook-html-rendering" id="toc-codebook-html-rendering" class="nav-link" data-scroll-target="#codebook-html-rendering"><span class="header-section-number">5.2</span> Codebook (HTML Rendering)</a></li>
  <li><a href="#codebook-table-rendering" id="toc-codebook-table-rendering" class="nav-link" data-scroll-target="#codebook-table-rendering"><span class="header-section-number">5.3</span> Codebook (Table Rendering)</a></li>
  <li><a href="#analytic-tibble" id="toc-analytic-tibble" class="nav-link" data-scroll-target="#analytic-tibble"><span class="header-section-number">5.4</span> Analytic Tibble</a></li>
  </ul></li>
  <li><a href="#summary-statistics" id="toc-summary-statistics" class="nav-link" data-scroll-target="#summary-statistics"><span class="header-section-number">6</span> Summary Statistics</a></li>
  <li><a href="#my-research-question" id="toc-my-research-question" class="nav-link" data-scroll-target="#my-research-question"><span class="header-section-number">7</span> My Research Question</a></li>
  <li><a href="#partitioning-the-data" id="toc-partitioning-the-data" class="nav-link" data-scroll-target="#partitioning-the-data"><span class="header-section-number">8</span> Partitioning the Data</a></li>
  <li><a href="#transforming-the-outcome" id="toc-transforming-the-outcome" class="nav-link" data-scroll-target="#transforming-the-outcome"><span class="header-section-number">9</span> Transforming the Outcome</a></li>
  <li><a href="#the-big-model" id="toc-the-big-model" class="nav-link" data-scroll-target="#the-big-model"><span class="header-section-number">10</span> The Big Model</a></li>
  <li><a href="#the-smaller-model" id="toc-the-smaller-model" class="nav-link" data-scroll-target="#the-smaller-model"><span class="header-section-number">11</span> The Smaller Model</a></li>
  <li><a href="#in-sample-comparison" id="toc-in-sample-comparison" class="nav-link" data-scroll-target="#in-sample-comparison"><span class="header-section-number">12</span> In-Sample Comparison</a>
  <ul class="collapse">
  <li><a href="#quality-of-fit" id="toc-quality-of-fit" class="nav-link" data-scroll-target="#quality-of-fit"><span class="header-section-number">12.1</span> Quality of Fit</a></li>
  <li><a href="#assessing-assumptions" id="toc-assessing-assumptions" class="nav-link" data-scroll-target="#assessing-assumptions"><span class="header-section-number">12.2</span> Assessing Assumptions</a></li>
  <li><a href="#posterior-predictive-checks" id="toc-posterior-predictive-checks" class="nav-link" data-scroll-target="#posterior-predictive-checks"><span class="header-section-number">12.3</span> Posterior Predictive Checks</a></li>
  <li><a href="#comparing-models" id="toc-comparing-models" class="nav-link" data-scroll-target="#comparing-models"><span class="header-section-number">12.4</span> Comparing Models</a></li>
  </ul></li>
  <li><a href="#model-validation" id="toc-model-validation" class="nav-link" data-scroll-target="#model-validation"><span class="header-section-number">13</span> Model Validation</a>
  <ul class="collapse">
  <li><a href="#calculating-prediction-errors" id="toc-calculating-prediction-errors" class="nav-link" data-scroll-target="#calculating-prediction-errors"><span class="header-section-number">13.1</span> Calculating Prediction Errors</a></li>
  <li><a href="#visualizing-predictions" id="toc-visualizing-predictions" class="nav-link" data-scroll-target="#visualizing-predictions"><span class="header-section-number">13.2</span> Visualizing Predictions</a></li>
  <li><a href="#summarizing-the-errors" id="toc-summarizing-the-errors" class="nav-link" data-scroll-target="#summarizing-the-errors"><span class="header-section-number">13.3</span> Summarizing the Errors</a></li>
  <li><a href="#comparing-the-models" id="toc-comparing-the-models" class="nav-link" data-scroll-target="#comparing-the-models"><span class="header-section-number">13.4</span> Comparing the Models</a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion"><span class="header-section-number">14</span> Discussion</a>
  <ul class="collapse">
  <li><a href="#chosen-model" id="toc-chosen-model" class="nav-link" data-scroll-target="#chosen-model"><span class="header-section-number">14.1</span> Chosen Model</a></li>
  <li><a href="#answering-my-question" id="toc-answering-my-question" class="nav-link" data-scroll-target="#answering-my-question"><span class="header-section-number">14.2</span> Answering My Question</a></li>
  <li><a href="#next-steps" id="toc-next-steps" class="nav-link" data-scroll-target="#next-steps"><span class="header-section-number">14.3</span> Next Steps</a></li>
  <li><a href="#reflection" id="toc-reflection" class="nav-link" data-scroll-target="#reflection"><span class="header-section-number">14.4</span> Reflection</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Blood Pressure Determinants: Investigating Relationship Between Lead Exposure and High Blood Pressure</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sofiya Vyshnya </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2025-09-28</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="central-hypothesis" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Central Hypothesis</h1>
<p>My central hypothesis for this study is that middle-aged adults (age 40-65) adults with heavy metal exposure (e.g.&nbsp;lead exposure) have higher systolic blood pressure. To test this hypothesis, I am using data gathered from NHANES during the years of 2017-March 2020 (the pre-pandemic years). In this study (Study 2 analyses), I am modeling the relationship between the concentration of lead in the blood and blood pressure.</p>
</section>
<section id="import-helper-functions" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Import Helper Functions</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R/helpers.R"</span>))  <span class="co"># absolute path to R/</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="setup-and-data-ingest" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Setup and Data Ingest</h1>
<p>The dataset consists of 2475 adults ages 40-65 participating in NHANES 2017-2020. The original NHANES data from 2017-2020 contained 9254 observations collected from individuals age 0-80. However, after selecting individuals aged 40-65, 2475 individuals were left.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xfun)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the dataset (consisting of 3 NHANES merged datasets on lab values and blood pressure. This dataset only contains the variables of interest and has been filtered by the appropriate age range)</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>nhanes_filtered <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/nhanes_data.rds"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="data-cleaning" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Data Cleaning</h1>
<p>Outliers (defined as values &lt; Q1- 1.5<em>IQR or &gt; Q3+1.5</em>IQR) were removed. Data were imputed using MICE. The resulting dataset has 2475 observations.</p>
<section id="data-imputation" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="data-imputation"><span class="header-section-number">4.1</span> Data Imputation</h2>
<section id="demonstration-of-missing-data-investigating-patterns-of-data-missingness-mcar-mar-nmar" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="demonstration-of-missing-data-investigating-patterns-of-data-missingness-mcar-mar-nmar"><span class="header-section-number">4.1.1</span> Demonstration of Missing Data &amp; Investigating Patterns of Data Missingness (MCAR, MAR, NMAR)</h3>
<p>First, I want to find out any patterns in my missing values to understand whether the data is missing completely at random (MCAR), missing at random (MAR), or missing not at random (MNAR).</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="nhanes_bp_leadExposure_files/figure-html/unnamed-chunk-3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="nhanes_bp_leadExposure_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 3
  variable n_miss pct_miss
  &lt;chr&gt;     &lt;int&gt;    &lt;num&gt;
1 BPXSY1      378    15.3 
2 BPXDI1      378    15.3 
3 LBXBPB      197     7.96
4 LBXBCD      197     7.96
5 LBXBMN      197     7.96
6 SEQN          0     0   
7 RIDAGEYR      0     0   
8 RIAGENDR      0     0   
9 RIDRETH1      0     0   </code></pre>
</div>
</div>
<p>The data is not missing completely at random. Missingness is observed in blocks/clusters: one cluster is for lab values (LBXBPB, LBXBCD, LBXBMN) and another is for blood pressure readings (BPXSY1, BPXDI1). Individuals who are missing one lab value are also going to be missing the others. Likewise, individuals who are missing one blood pressure reading will also be missing the others. Furthermore, it’s possible that individuals missing lab values are also more likely to have blood pressure readings missing. To investigate this, I will use a Chi square test to see if there is any dependency in the missingness of lab values and blood pressure:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create indicators</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>nhanes_filtered<span class="sc">$</span>lab_missing  <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">is.na</span>(nhanes_filtered<span class="sc">$</span>LBXBPB) <span class="sc">|</span> <span class="fu">is.na</span>(nhanes_filtered<span class="sc">$</span>LBXBCD) <span class="sc">|</span> <span class="fu">is.na</span>(nhanes_filtered<span class="sc">$</span>LBXBMN)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>nhanes_filtered<span class="sc">$</span>bp_missing   <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">is.na</span>(nhanes_filtered<span class="sc">$</span>BPXSY1) <span class="sc">|</span> <span class="fu">is.na</span>(nhanes_filtered<span class="sc">$</span>BPXDI1)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Contingency table</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">table</span>(nhanes_filtered<span class="sc">$</span>lab_missing, nhanes_filtered<span class="sc">$</span>bp_missing)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>tab</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
       0    1
  0 2015  263
  1   82  115</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Chi-squared test</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(tab)    </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  tab
X-squared = 303.69, df = 1, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Effect size: Cramer's V (equivalent to phi coefficient for 2x2)</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rcompanion)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cramerV</span>(tab)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cramer V 
  0.3524 </code></pre>
</div>
</div>
<p>The significant test result and moderate effect size suggests some dependency: individuals missing lab values are also somewhat more likely to have BP values missing (or vice versa?).</p>
<p>Next, I want to check if the missingness is associated with observed covariates. This makes it more likely that the missing values are MAR.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = lab_missing ~ RIDAGEYR + RIAGENDR + RIDRETH1, family = binomial, 
    data = nhanes_filtered)

Coefficients:
                            Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)                -1.496040   0.564560  -2.650  0.00805 **
RIDAGEYR                   -0.022070   0.009855  -2.239  0.02513 * 
RIAGENDRFemale             -0.137618   0.149291  -0.922  0.35663   
RIDRETH1Other Hispanic     -0.649419   0.421871  -1.539  0.12371   
RIDRETH1Non-Hispanic White  0.234973   0.262735   0.894  0.37114   
RIDRETH1Non-Hispanic Black  0.579121   0.257134   2.252  0.02431 * 
RIDRETH1Other/Multiracial   0.428955   0.265799   1.614  0.10656   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1375.0  on 2474  degrees of freedom
Residual deviance: 1352.3  on 2468  degrees of freedom
AIC: 1366.3

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = bp_missing ~ RIDAGEYR + RIAGENDR + RIDRETH1, family = binomial, 
    data = nhanes_filtered)

Coefficients:
                            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                -1.656627   0.427797  -3.872 0.000108 ***
RIDAGEYR                   -0.004570   0.007429  -0.615 0.538452    
RIAGENDRFemale              0.141990   0.112422   1.263 0.206587    
RIDRETH1Other Hispanic      0.132636   0.231888   0.572 0.567332    
RIDRETH1Non-Hispanic White  0.029522   0.187244   0.158 0.874719    
RIDRETH1Non-Hispanic Black  0.280575   0.185378   1.514 0.130146    
RIDRETH1Other/Multiracial   0.070331   0.194831   0.361 0.718109    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2115.7  on 2474  degrees of freedom
Residual deviance: 2110.0  on 2468  degrees of freedom
AIC: 2124

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p>From the regression otput, it appears that missingness in lab values is related to observed covariates in the dataset – certain sexes and races are more likely to have data missing. Therefore, I can plausibly assume that the data is missing at random (MAR). However, for blood pressure values, that does not seem to be the case. It is therefore possible that missingness is driven by some unobserved variable and BP values could be NMAR. However, for the purposes of this assignment, <em>I will assume that all data is MAR</em>. Thus, standard imputation methods like multiple imputation (MICE) are appropriate.</p>
</section>
<section id="imputation-method-mice-based-on-desired-model-that-uses-heavy-metal-concentrations-in-the-blood-raceethnicity-sex-to-predict-systolic-blood-pressure" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="imputation-method-mice-based-on-desired-model-that-uses-heavy-metal-concentrations-in-the-blood-raceethnicity-sex-to-predict-systolic-blood-pressure"><span class="header-section-number">4.1.2</span> Imputation Method: MICE (Based on Desired Model that uses heavy metal concentrations in the blood + race/ethnicity + sex to predict systolic blood pressure)</h3>
<p>I used predictive mean matching (PMM) for continuous variables. The categorical variables in the dataset (sex, race/ethnicity) had no missing values according to the heatmap in the section “Demonstration of Missing Data &amp; Investigating Patterns of Data Missingness (MCAR, MAR, NMAR)”. Only predictor variables were imputed; the outcome variable, systolic blood pressure (BPXSY1), was not imputed.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Impute filtered dataset </span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define methods per variable</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>meth <span class="ot">&lt;-</span> <span class="fu">make.method</span>(nhanes_filtered)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>meth[<span class="fu">c</span>(<span class="st">"LBXBPB"</span>, <span class="st">"LBXBCD"</span>, <span class="st">"LBXBMN"</span>)] <span class="ot">&lt;-</span> <span class="st">"pmm"</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>meth[<span class="st">"SEQN"</span>] <span class="ot">&lt;-</span> <span class="st">""</span>  <span class="co"># ID variable excluded</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform imputation</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> <span class="fu">mice</span>(</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  nhanes_filtered,</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">m =</span> <span class="dv">1</span>,       <span class="co"># single imputed dataset</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> meth,</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">maxit =</span> <span class="dv">20</span>,</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">printFlag =</span> <span class="cn">FALSE</span>    <span class="co"># &lt;-- suppress iteration output</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Complete data after imputation</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>nhanes_imputed <span class="ot">&lt;-</span> <span class="fu">complete</span>(imp, <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>       SEQN    RIDAGEYR    RIAGENDR    RIDRETH1      LBXBPB      LBXBCD 
          0           0           0           0           0           0 
     LBXBMN      BPXSY1      BPXDI1 lab_missing  bp_missing 
          0           0           0           0           0 </code></pre>
</div>
</div>
<p>The only missing values should be in the outcome variable, not the predictor variables.</p>
</section>
</section>
<section id="outlier-removal" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="outlier-removal"><span class="header-section-number">4.2</span> Outlier Removal</h2>
<p>Outliers (defined as values &lt; Q1- 1.5<em>IQR or &gt; Q3+1.5</em>IQR) were removed. An alternative strategy would be to impute outliers instead of simply dropping them.</p>
</section>
</section>
<section id="dataset-description-and-codebook" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Dataset Description and Codebook</h1>
<section id="dataset-description-summary-statistics" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="dataset-description-summary-statistics"><span class="header-section-number">5.1</span> Dataset Description &amp; Summary Statistics</h2>
<p>Table 1: Variables included in the data.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Data Type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>SEQN</strong></td>
<td style="text-align: left;">Subject ID: Individual Identifier</td>
<td style="text-align: left;">Quantitative (Integer)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>RIDAGEYR</strong></td>
<td style="text-align: left;">Age: Age in years at screening, range 40-65</td>
<td style="text-align: left;">Quantitative (Integer)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>RIAGENDR</strong></td>
<td style="text-align: left;">Sex: male or female</td>
<td style="text-align: left;">Binary</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>RIDRETH1</strong></td>
<td style="text-align: left;">Race</td>
<td style="text-align: left;">Multi-level Categorical</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>LBXBPB</strong></td>
<td style="text-align: left;">Blood lead (µg/dL)</td>
<td style="text-align: left;">Quantitative (Continuous)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>LBXBPB_clean</strong></td>
<td style="text-align: left;"><strong>Key Predictor</strong>: Blood lead after outlier removal</td>
<td style="text-align: left;">Quantitative (Continuous)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>LBXBCD</strong></td>
<td style="text-align: left;">Blood cadmium (µg/dL)</td>
<td style="text-align: left;">Quantitative (Continuous)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>LBXBCD_clean</strong></td>
<td style="text-align: left;"><strong>Key Predictor</strong>: Blood cadmium (µg/dL) after outlier removal</td>
<td style="text-align: left;">Quantitative (Continuous)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>LBXBMN</strong></td>
<td style="text-align: left;">Blood manganese (µg/dL)</td>
<td style="text-align: left;">Quantitative (Continuous)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>LBXBMN_clean</strong></td>
<td style="text-align: left;"><strong>Key Predictor</strong>: Blood manganese (µg/dL) after outlier removal</td>
<td style="text-align: left;">Quantitative (Continuous)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>BPXSY1</strong></td>
<td style="text-align: left;">Systolic BP, first reading</td>
<td style="text-align: left;">Quantitative (Integer)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>BPXSY1_clean</strong></td>
<td style="text-align: left;"><strong>Outcome</strong>: Systolic BP, first reading, after outlier removal</td>
<td style="text-align: left;">Quantitative (Integer)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>BPXDI1</strong></td>
<td style="text-align: left;">Diastolic BP, first reading</td>
<td style="text-align: left;">Quantitative (Integer)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>BPXDI1_clean</strong></td>
<td style="text-align: left;">Diastolic BP, first reading, after outlier removal</td>
<td style="text-align: left;">Quantitative (Integer)</td>
</tr>
</tbody>
</table>
<p>Summary statistics for the continuous and categorical variables:</p>
<p>Table 2: Summary of numeric data. “_clean” indicates that outliers were removed.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">mean</th>
<th style="text-align: left;">stdev</th>
<th style="text-align: left;">median</th>
<th style="text-align: left;">min</th>
<th style="text-align: left;">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>RIDAGEYR</strong></td>
<td style="text-align: left;">53.46</td>
<td style="text-align: left;">7.59</td>
<td style="text-align: left;">54.00</td>
<td style="text-align: left;">40.00</td>
<td style="text-align: left;">65.00</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>LBXBPB</strong></td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">0.54</td>
<td style="text-align: left;">0.94</td>
<td style="text-align: left;">0.12</td>
<td style="text-align: left;">2.79</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>LBXBCD</strong></td>
<td style="text-align: left;">0.37</td>
<td style="text-align: left;">0.25</td>
<td style="text-align: left;">0.30</td>
<td style="text-align: left;">0.07</td>
<td style="text-align: left;">1.21</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>LBXBMN</strong></td>
<td style="text-align: left;">9.67</td>
<td style="text-align: left;">3.01</td>
<td style="text-align: left;">9.32</td>
<td style="text-align: left;">3.07</td>
<td style="text-align: left;">18.34</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>BPXSY1</strong></td>
<td style="text-align: left;">126.68</td>
<td style="text-align: left;">16.01</td>
<td style="text-align: left;">126.00</td>
<td style="text-align: left;">88.00</td>
<td style="text-align: left;">170.00</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>BPXDI1</strong></td>
<td style="text-align: left;">76.17</td>
<td style="text-align: left;">10.02</td>
<td style="text-align: left;">76.00</td>
<td style="text-align: left;">50.00</td>
<td style="text-align: left;">104.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>LBXBPB_clean</strong></td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">0.54</td>
<td style="text-align: left;">0.94</td>
<td style="text-align: left;">0.11</td>
<td style="text-align: left;">0.12</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>LBXBCD_clean</strong></td>
<td style="text-align: left;">0.37</td>
<td style="text-align: left;">0.25</td>
<td style="text-align: left;">0.30</td>
<td style="text-align: left;">0.07</td>
<td style="text-align: left;">0.07</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>LBXBMN_clean</strong></td>
<td style="text-align: left;">9.67</td>
<td style="text-align: left;">3.01</td>
<td style="text-align: left;">9.32</td>
<td style="text-align: left;">1.40</td>
<td style="text-align: left;">3.07</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>BPXSY1_clean</strong></td>
<td style="text-align: left;">126.68</td>
<td style="text-align: left;">16.01</td>
<td style="text-align: left;">126.00</td>
<td style="text-align: left;">88.00</td>
<td style="text-align: left;">170.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>BPXDI1_clean</strong></td>
<td style="text-align: left;">76.17</td>
<td style="text-align: left;">10.02</td>
<td style="text-align: left;">76.00</td>
<td style="text-align: left;">50.00</td>
<td style="text-align: left;">104.00</td>
</tr>
</tbody>
</table>
<p>Table 3: Summary of categorical data.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Count (Percent)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>RIAGENDR: Sex</strong></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Male</td>
<td style="text-align: left;">943 (47.99%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Female</td>
<td style="text-align: left;">1022 (52.01%)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>RIDRETH1: Race</strong></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mexican American</td>
<td style="text-align: left;">294 (14.96%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other Hispanic</td>
<td style="text-align: left;">218 (11.09%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Non-Hispanic White</td>
<td style="text-align: left;">559 (28.44%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Non-Hispanic Black</td>
<td style="text-align: left;">489 (24.88%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other Race - Including Multi-Racial</td>
<td style="text-align: left;">405 (20.61%)</td>
</tr>
</tbody>
</table>
</section>
<section id="codebook-html-rendering" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="codebook-html-rendering"><span class="header-section-number">5.2</span> Codebook (HTML Rendering)</h2>
<p>Check out HTML codebook <a href="../../../../data/study2/codebook.html">here →</a></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(labelled)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dataReporter)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign variable labels</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>var_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">SEQN =</span> <span class="st">"Subject ID: Individual Identifier"</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">RIDAGEYR =</span> <span class="st">"Age in years at screening (40-65)"</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">RIAGENDR =</span> <span class="st">"Sex: male or female"</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">RIDRETH1 =</span> <span class="st">"Race / Ethnicity"</span>,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">LBXBPB =</span> <span class="st">"Blood lead (µg/dL)"</span>,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">LBXBPB_clean =</span> <span class="st">"Blood lead after outlier removal"</span>,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">LBXBCD =</span> <span class="st">"Blood cadmium (µg/dL)"</span>,</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">LBXBCD_clean =</span> <span class="st">"Blood cadmium after outlier removal"</span>,</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">LBXBMN =</span> <span class="st">"Blood manganese (µg/dL)"</span>,</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">LBXBMN_clean =</span> <span class="st">"Blood manganese after outlier removal"</span>,</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">BPXSY1 =</span> <span class="st">"Systolic BP, first reading"</span>,</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">BPXSY1_clean =</span> <span class="st">"Systolic BP, first reading after outlier removal"</span>,</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">BPXDI1 =</span> <span class="st">"Diastolic BP, first reading"</span>,</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">BPXDI1_clean =</span> <span class="st">"Diastolic BP, first reading after outlier removal"</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert your named character vector to a named list</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>var_labels_list <span class="ot">&lt;-</span> <span class="fu">as.list</span>(var_labels)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply labels to the dataframe</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>nhanes_clean <span class="ot">&lt;-</span> <span class="fu">set_variable_labels</span>(nhanes_clean, <span class="at">.labels =</span> var_labels_list)</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="fu">makeCodebook</span>(nhanes_clean, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/study2/codebook.html"</span>), <span class="at">output =</span> <span class="st">"html"</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="codebook-table-rendering" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="codebook-table-rendering"><span class="header-section-number">5.3</span> Codebook (Table Rendering)</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 9
   variable     type    missing      min      q25  median    mean     q75    max
   &lt;chr&gt;        &lt;chr&gt;     &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
 1 SEQN         numeric       0 93711    95997    9.83e+4 9.83e+4 1.01e+5 1.03e5
 2 RIDAGEYR     numeric       0    40       47    5.4 e+1 5.35e+1 6   e+1 6.5 e1
 3 LBXBPB       numeric       0     0.12     0.61 9.4 e-1 1.04e+0 1.33e+0 2.79e0
 4 LBXBCD       numeric       0     0.07     0.18 3   e-1 3.72e-1 4.8 e-1 1.21e0
 5 LBXBMN       numeric       0     3.07     7.46 9.32e+0 9.67e+0 1.15e+1 1.83e1
 6 BPXSY1       numeric       0    88      116    1.26e+2 1.27e+2 1.38e+2 1.7 e2
 7 BPXDI1       numeric       0    50       70    7.6 e+1 7.62e+1 8.2 e+1 1.04e2
 8 lab_missing  integer       0     0        0    0       7.33e-2 0       1   e0
 9 bp_missing   integer       0     0        0    0       1.54e-1 0       1   e0
10 LBXBPB_clean numeric       0     0.12     0.61 9.4 e-1 1.04e+0 1.33e+0 2.79e0
11 LBXBCD_clean numeric       0     0.07     0.18 3   e-1 3.72e-1 4.8 e-1 1.21e0
12 LBXBMN_clean numeric       0     3.07     7.46 9.32e+0 9.67e+0 1.15e+1 1.83e1
13 BPXSY1_clean numeric       0    88      116    1.26e+2 1.27e+2 1.38e+2 1.7 e2
14 BPXDI1_clean numeric       0    50       70    7.6 e+1 7.62e+1 8.2 e+1 1.04e2</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  variable type   missing n_unique levels                                       
  &lt;chr&gt;    &lt;chr&gt;    &lt;int&gt;    &lt;int&gt; &lt;chr&gt;                                        
1 RIAGENDR factor       0        2 Male, Female                                 
2 RIDRETH1 factor       0        5 Other/Multiracial, Non-Hispanic Black, Mexic…</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 4
  variable level              count missing
  &lt;chr&gt;    &lt;fct&gt;              &lt;int&gt;   &lt;int&gt;
1 RIAGENDR Male                 943       0
2 RIAGENDR Female              1022       0
3 RIDRETH1 Mexican American     294       0
4 RIDRETH1 Other Hispanic       218       0
5 RIDRETH1 Non-Hispanic White   559       0
6 RIDRETH1 Non-Hispanic Black   489       0
7 RIDRETH1 Other/Multiracial    405       0</code></pre>
</div>
</div>
</section>
<section id="analytic-tibble" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="analytic-tibble"><span class="header-section-number">5.4</span> Analytic Tibble</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   SEQN RIDAGEYR RIAGENDR           RIDRETH1 LBXBPB LBXBCD LBXBMN BPXSY1 BPXDI1
1 93711       56     Male  Other/Multiracial   2.15   0.38   6.55    108     68
2 93714       54   Female Non-Hispanic Black   0.71   0.31   7.85    126     76
3 93716       61     Male  Other/Multiracial   1.99   0.23   8.80    120     72
4 93718       45     Male Non-Hispanic Black   0.62   0.10  12.00    128     88
5 93721       60   Female   Mexican American   0.75   0.18   9.92    132     68
6 93722       60   Female Non-Hispanic White   0.98   0.38  15.05    116     68
  lab_missing bp_missing LBXBPB_clean LBXBCD_clean LBXBMN_clean BPXSY1_clean
1           0          0         2.15         0.38         6.55          108
2           0          1         0.71         0.31         7.85          126
3           0          0         1.99         0.23         8.80          120
4           0          0         0.62         0.10        12.00          128
5           0          0         0.75         0.18         9.92          132
6           0          0         0.98         0.38        15.05          116
  BPXDI1_clean
1           68
2           76
3           72
4           88
5           68
6           68</code></pre>
</div>
</div>
</section>
</section>
<section id="summary-statistics" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Summary Statistics</h1>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>             vars    n     mean      sd   median  trimmed     mad      min
SEQN            1 1965 98330.19 2706.83 98334.00 98325.70 3435.18 93711.00
RIDAGEYR        2 1965    53.46    7.59    54.00    53.69   10.38    40.00
RIAGENDR*       3 1965     1.52    0.50     2.00     1.53    0.00     1.00
RIDRETH1*       4 1965     3.25    1.31     3.00     3.31    1.48     1.00
LBXBPB          5 1965     1.04    0.54     0.94     0.98    0.52     0.12
LBXBCD          6 1965     0.37    0.25     0.30     0.34    0.21     0.07
LBXBMN          7 1965     9.67    3.01     9.32     9.50    2.98     3.07
BPXSY1          8 1965   126.68   16.01   126.00   126.09   14.83    88.00
BPXDI1          9 1965    76.17   10.02    76.00    76.07    8.90    50.00
lab_missing    10 1965     0.07    0.26     0.00     0.00    0.00     0.00
bp_missing     11 1965     0.15    0.36     0.00     0.07    0.00     0.00
LBXBPB_clean   12 1965     1.04    0.54     0.94     0.98    0.52     0.12
LBXBCD_clean   13 1965     0.37    0.25     0.30     0.34    0.21     0.07
LBXBMN_clean   14 1965     9.67    3.01     9.32     9.50    2.98     3.07
BPXSY1_clean   15 1965   126.68   16.01   126.00   126.09   14.83    88.00
BPXDI1_clean   16 1965    76.17   10.02    76.00    76.07    8.90    50.00
                   max   range  skew kurtosis    se
SEQN         102954.00 9243.00  0.01    -1.20 61.06
RIDAGEYR         65.00   25.00 -0.20    -1.23  0.17
RIAGENDR*         2.00    1.00 -0.08    -1.99  0.01
RIDRETH1*         5.00    4.00 -0.32    -0.93  0.03
LBXBPB            2.79    2.67  0.88     0.38  0.01
LBXBCD            1.21    1.14  1.21     0.90  0.01
LBXBMN           18.34   15.27  0.49    -0.17  0.07
BPXSY1          170.00   82.00  0.32    -0.24  0.36
BPXDI1          104.00   54.00  0.09    -0.09  0.23
lab_missing       1.00    1.00  3.27     8.71  0.01
bp_missing        1.00    1.00  1.92     1.68  0.01
LBXBPB_clean      2.79    2.67  0.88     0.38  0.01
LBXBCD_clean      1.21    1.14  1.21     0.90  0.01
LBXBMN_clean     18.34   15.27  0.49    -0.17  0.07
BPXSY1_clean    170.00   82.00  0.32    -0.24  0.36
BPXDI1_clean    104.00   54.00  0.09    -0.09  0.23</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  variable              level    n Proportion
1 RIAGENDR               Male  943  0.4798982
2 RIAGENDR             Female 1022  0.5201018
3 RIDRETH1   Mexican American  294  0.1496183
4 RIDRETH1     Other Hispanic  218  0.1109415
5 RIDRETH1 Non-Hispanic White  559  0.2844784
6 RIDRETH1 Non-Hispanic Black  489  0.2488550
7 RIDRETH1  Other/Multiracial  405  0.2061069</code></pre>
</div>
</div>
</section>
<section id="my-research-question" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> My Research Question</h1>
<p><em>How does blood pressure vary with concentration of heavy metals in the blood?</em> I know that heavy metals can lead to inflammation, which can affect cardiovascular health. My hypothesis is that blood pressure has a positive relationship with heavy metal concentrations in the blood. In Study 1, I learned that blood pressure is also influenced by sex (to a small degree) and by race/ethnicity (to a larger degree), so I will control for these demographic variables.</p>
</section>
<section id="partitioning-the-data" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Partitioning the Data</h1>
<p>Perform an 80/20 train/test split:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>numeric(0)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>numeric(0)</code></pre>
</div>
</div>
</section>
<section id="transforming-the-outcome" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Transforming the Outcome</h1>
<p>I did not transform the outcome variable (systolic BP) because it already follows an approximately Gaussian distribution. Furthermore, model fit results in the subsequent sections reveal that errors are normally-distributed when using the un-transformed data.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="nhanes_bp_leadExposure_files/figure-html/unnamed-chunk-18-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="nhanes_bp_leadExposure_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="the-big-model" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> The Big Model</h1>
<p>I am regressing systolic BP on blood concentrations of heavy metals (lead: LBXBPB, cadmium: LBXBCD, and manganese: LBXBMN). I am also controlling for potential demographic influences on systolic BP – age, sex, and race/ethnicity.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BPXSY1_clean ~ LBXBPB_clean + LBXBCD_clean + LBXBMN_clean + 
    RIDAGEYR + RIAGENDR + RIDRETH1, data = train_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-40.902 -10.656  -0.262   9.889  45.983 

Coefficients:
                           Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                93.65505    3.30426  28.344  &lt; 2e-16 ***
LBXBPB_clean               -0.07250    0.77101  -0.094 0.925099    
LBXBCD_clean                0.04756    1.57942   0.030 0.975983    
LBXBMN_clean                0.14274    0.13824   1.033 0.301969    
RIDAGEYR                    0.61415    0.05284  11.624  &lt; 2e-16 ***
RIAGENDRFemale             -1.99302    0.80066  -2.489 0.012905 *  
RIDRETH1Other Hispanic     -1.29105    1.51849  -0.850 0.395331    
RIDRETH1Non-Hispanic White -2.98888    1.23533  -2.420 0.015655 *  
RIDRETH1Non-Hispanic Black  4.64059    1.27887   3.629 0.000294 ***
RIDRETH1Other/Multiracial  -1.06594    1.35144  -0.789 0.430379    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 15.17 on 1562 degrees of freedom
Multiple R-squared:  0.1197,    Adjusted R-squared:  0.1146 
F-statistic:  23.6 on 9 and 1562 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  r.squared adj.r.squared    AIC    BIC
      &lt;dbl&gt;         &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1      0.12         0.115 13022. 13081.</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataframe for plotting</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>resid_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Fitted =</span> model<span class="sc">$</span>fitted.values,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Residuals =</span> model<span class="sc">$</span>residuals</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(resid_data, <span class="fu">aes</span>(<span class="at">x =</span> Fitted, <span class="at">y =</span> Residuals)) <span class="sc">+</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span>                        <span class="co"># scatter points</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span> <span class="co"># LOESS smooth</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Residuals vs Fitted with LOESS"</span>,</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Fitted values"</span>,</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Residuals"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="nhanes_bp_leadExposure_files/figure-html/unnamed-chunk-20-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="nhanes_bp_leadExposure_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="the-smaller-model" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> The Smaller Model</h1>
<p>I am regressing systolic BP on blood concentrations of heavy metals (lead: LBXBPB, cadmium: LBXBCD, and manganese: LBXBMN). I am, however, leaving out the demographic features.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear regression predicting systolic BP from heavy metal concentration in blood</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>model_small <span class="ot">&lt;-</span> <span class="fu">lm</span>(BPXSY1_clean <span class="sc">~</span> LBXBPB_clean <span class="sc">+</span> LBXBCD_clean <span class="sc">+</span> LBXBMN_clean, <span class="at">data =</span> train_data)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model fit statistics</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>model_stats_small <span class="ot">&lt;-</span> <span class="fu">glance</span>(model_small) <span class="sc">%&gt;%</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(r.squared, adj.r.squared, AIC, BIC) <span class="sc">%&gt;%</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="dv">3</span>))</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize results</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_small)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BPXSY1_clean ~ LBXBPB_clean + LBXBCD_clean + LBXBMN_clean, 
    data = train_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-42.876 -11.351  -0.854  10.205  45.903 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  125.7252     1.6309  77.091  &lt; 2e-16 ***
LBXBPB_clean   2.8714     0.7638   3.759 0.000177 ***
LBXBCD_clean  -0.2013     1.6169  -0.125 0.900928    
LBXBMN_clean  -0.2013     0.1354  -1.487 0.137099    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 16.05 on 1568 degrees of freedom
Multiple R-squared:  0.01094,   Adjusted R-squared:  0.009046 
F-statistic:  5.78 on 3 and 1568 DF,  p-value: 0.0006276</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>model_stats_small</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  r.squared adj.r.squared    AIC    BIC
      &lt;dbl&gt;         &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1     0.011         0.009 13193. 13220.</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataframe for plotting</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>resid_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Fitted =</span> model_small<span class="sc">$</span>fitted.values,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Residuals =</span> model_small<span class="sc">$</span>residuals</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(resid_data, <span class="fu">aes</span>(<span class="at">x =</span> Fitted, <span class="at">y =</span> Residuals)) <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span>                        <span class="co"># scatter points</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span> <span class="co"># LOESS smooth</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Residuals vs Fitted with LOESS"</span>,</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Fitted values"</span>,</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Residuals"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="nhanes_bp_leadExposure_files/figure-html/unnamed-chunk-22-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="nhanes_bp_leadExposure_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="in-sample-comparison" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> In-Sample Comparison</h1>
<section id="quality-of-fit" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="quality-of-fit"><span class="header-section-number">12.1</span> Quality of Fit</h2>
<p>The full model does a much better job predicting blood pressure. It has a significantly higher adjusted <span class="math inline">\(R^2\)</span> (full: 0.115, small: 0.009) and lower AIC (full: 13022.1, small: 13193.24) and BIC (full: 13081.06, small: 13220.04).</p>
</section>
<section id="assessing-assumptions" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="assessing-assumptions"><span class="header-section-number">12.2</span> Assessing Assumptions</h2>
<p>Moreover, in the full model, the residuals are normally-distributed with a mean of 0, exhibit no correlation, and have constant variance – meet iid assumptions. In the reduced model, the residual-vs-fitted plot shows some correlation at smaller systolic BP values, suggesting that the model is under-predicting the actual data. The small model is missing some key predictors, leading to omitted variable bias (observed as correlated residuals for small fitted values).</p>
</section>
<section id="posterior-predictive-checks" class="level2" data-number="12.3">
<h2 data-number="12.3" class="anchored" data-anchor-id="posterior-predictive-checks"><span class="header-section-number">12.3</span> Posterior Predictive Checks</h2>
<p>The smaller model tends to underpredict low values of BPXSY1, suggesting a possible non-linear effect or omission of an important predictor. The relationship linearizes with inclusion of demographic predictors in the full model, however, suggesting omitted variable bias.</p>
</section>
<section id="comparing-models" class="level2" data-number="12.4">
<h2 data-number="12.4" class="anchored" data-anchor-id="comparing-models"><span class="header-section-number">12.4</span> Comparing Models</h2>
<p>The full model outperforms the small model in nearly every way. The performance metrics are better (including AIC and BIC, which penalize for including extra parameters; however, the additional demographic predictors were key to modeling systolic blood pressure, so including them outweighed any penalties for increasing the number of features. Also, including demographics corrected the omitted variable bias observed in the residuals-vs-fitted plot.</p>
</section>
</section>
<section id="model-validation" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Model Validation</h1>
<section id="calculating-prediction-errors" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="calculating-prediction-errors"><span class="header-section-number">13.1</span> Calculating Prediction Errors</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 393 × 9
   actual pred_small pred_big err_small err_big abs_err_small abs_err_big
    &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;         &lt;dbl&gt;       &lt;dbl&gt;
 1    120       130.     131.      9.62   11.2           9.62       11.2 
 2    124       127.     131.      2.98    7.00          2.98        7.00
 3    120       125.     116.      5.29   -3.71          5.29        3.71
 4    132       126.     130.     -5.90   -1.84          5.90        1.84
 5    142       129.     138.    -13.4    -3.68         13.4         3.68
 6    100       128.     125.     28.2    24.7          28.2        24.7 
 7    108       125.     114.     17.5     6.07         17.5         6.07
 8    114       128.     132.     14.3    17.6          14.3        17.6 
 9    158       128.     133.    -29.6   -24.6          29.6        24.6 
10    138       125.     130.    -13.5    -7.85         13.5         7.85
# ℹ 383 more rows
# ℹ 2 more variables: sq_err_small &lt;dbl&gt;, sq_err_big &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="visualizing-predictions" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="visualizing-predictions"><span class="header-section-number">13.2</span> Visualizing Predictions</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="nhanes_bp_leadExposure_files/figure-html/unnamed-chunk-24-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="nhanes_bp_leadExposure_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="summarizing-the-errors" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="summarizing-the-errors"><span class="header-section-number">13.3</span> Summarizing the Errors</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Root Mean Squared Prediction Error (RMSPE)</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>rmspe_small <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(errors<span class="sc">$</span>sq_err_small))</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>rmspe_big   <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(errors<span class="sc">$</span>sq_err_big))</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean Absolute Prediction Error (MAPE)</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>mape_small <span class="ot">&lt;-</span> <span class="fu">mean</span>(errors<span class="sc">$</span>abs_err_small)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>mape_big   <span class="ot">&lt;-</span> <span class="fu">mean</span>(errors<span class="sc">$</span>abs_err_big)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Maximum Absolute Error (MaxAE)</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>maxae_small <span class="ot">&lt;-</span> <span class="fu">max</span>(errors<span class="sc">$</span>abs_err_small)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>maxae_big   <span class="ot">&lt;-</span> <span class="fu">max</span>(errors<span class="sc">$</span>abs_err_big)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Squared correlation between actual and predicted (validated R^2)</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>val_r2_small <span class="ot">&lt;-</span> <span class="fu">cor</span>(errors<span class="sc">$</span>actual, errors<span class="sc">$</span>pred_small)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>val_r2_big   <span class="ot">&lt;-</span> <span class="fu">cor</span>(errors<span class="sc">$</span>actual, errors<span class="sc">$</span>pred_big)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize in a tibble</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>error_summary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Small Model"</span>, <span class="st">"Big Model"</span>),</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSPE =</span> <span class="fu">c</span>(rmspe_small, rmspe_big),</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">MAPE =</span> <span class="fu">c</span>(mape_small, mape_big),</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">MaxAE =</span> <span class="fu">c</span>(maxae_small, maxae_big),</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_val =</span> <span class="fu">c</span>(val_r2_small, val_r2_big)</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="dv">3</span>))</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Display nicely</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(error_summary, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">dom =</span> <span class="st">'t'</span>, <span class="at">paging =</span> <span class="cn">FALSE</span>), <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-dfc60d69b72f58027516" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-dfc60d69b72f58027516">{"x":{"filter":"none","vertical":false,"data":[["Small Model","Big Model"],[15.549,14.56],[12.476,11.605],[41.837,45.921],[0.004,0.125]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Model<\/th>\n      <th>RMSPE<\/th>\n      <th>MAPE<\/th>\n      <th>MaxAE<\/th>\n      <th>R2_val<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","paging":false,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"name":"Model","targets":0},{"name":"RMSPE","targets":1},{"name":"MAPE","targets":2},{"name":"MaxAE","targets":3},{"name":"R2_val","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="comparing-the-models" class="level2" data-number="13.4">
<h2 data-number="13.4" class="anchored" data-anchor-id="comparing-the-models"><span class="header-section-number">13.4</span> Comparing the Models</h2>
<p>The big model has slightly lower RMSPE and MAPE, and its predicted range closely matches the observed systolic BP, while the small model predicts both high and low values poorly. Its predictions are all very similar – from the scatter plot, the model seems to be guessing the average systolic blood pressure value in the training set. This is likely because the predictors that meaningfully describe systolic blood pressure are absent from the model, and the model is just guessing. Based on these metrics and the scatter plots, I would prefer the big model for prediction in this test sample.</p>
</section>
</section>
<section id="discussion" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> Discussion</h1>
<section id="chosen-model" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="chosen-model"><span class="header-section-number">14.1</span> Chosen Model</h2>
<p>I chose the big model.</p>
</section>
<section id="answering-my-question" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="answering-my-question"><span class="header-section-number">14.2</span> Answering My Question</h2>
<p>I see no evidence that blood concentrations of heavy metals have a relationship with systolic blood pressure. This goes against my hypothesis. However, my hypothesis was based on papers looking at individuals with extremely high lead levels in the blood (&gt;5 µg/dL), but patients in my data seldom had blood levels this high. Moreover, surprisingly (according to Study 2 and my dashboard), blood lead levels do not appear to be correlated with sociodemographic variables (and are not subsumed by any sociodemographic variables). During preprocessing, I removed outliers (really high blood levels of lead, cadium, and manganese), and perhaps if I had left those values in the dataset, my result may have been different. However, there were so few individuals with high levels of heavy metals in the blood that the effect would likely have been negligible.</p>
</section>
<section id="next-steps" class="level2" data-number="14.3">
<h2 data-number="14.3" class="anchored" data-anchor-id="next-steps"><span class="header-section-number">14.3</span> Next Steps</h2>
<p>Since demographics have a strong relationship with systolic blood pressure, I would like to investigate additional demographic variables, such as education, and how they are related to systolic blood pressure. I would also like to replicate my analyses on diastolic blood pressure to see if the same trend holds.</p>
</section>
<section id="reflection" class="level2" data-number="14.4">
<h2 data-number="14.4" class="anchored" data-anchor-id="reflection"><span class="header-section-number">14.4</span> Reflection</h2>
<p>One of the key things I learned is how to render data generated from my analyses on a website. I started with working on Study 1 and Study 2 and then did my dashboard. While working on the dashboard, I realized the power of data tables from the DT library and how aesthetic they make the results look. I would have implemented the data table format throughout my Study 1 and Study 2 analyses so that the results are more legible when I render my Study 1 and Study 2 reports in HTML.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sessioninfo)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">session_info</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>─ Session info ───────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.5.1 (2025-06-13 ucrt)
 os       Windows 11 x64 (build 26100)
 system   x86_64, mingw32
 ui       RTerm
 language (EN)
 collate  English_United States.utf8
 ctype    English_United States.utf8
 tz       America/New_York
 date     2025-09-28
 pandoc   3.6.3 @ C:\\Users\\User\\AppData\\Local\\Programs\\Quarto\\bin\\tools/ (via rmarkdown)
 quarto   NA @ C:\\Users\\User\\AppData\\Local\\Programs\\Quarto\\bin\\quarto.exe

─ Packages ───────────────────────────────────────────────────────────────────
 package      * version date (UTC) lib source
 backports      1.5.0   2024-05-23 [1] CRAN (R 4.5.0)
 boot           1.3-31  2024-08-28 [2] CRAN (R 4.5.1)
 broom          1.0.10  2025-09-13 [1] CRAN (R 4.5.1)
 bslib          0.9.0   2025-01-30 [1] CRAN (R 4.5.1)
 cachem         1.1.0   2024-05-16 [1] CRAN (R 4.5.1)
 cellranger     1.1.0   2016-07-27 [1] CRAN (R 4.5.1)
 class          7.3-23  2025-01-01 [2] CRAN (R 4.5.1)
 cli            3.6.5   2025-04-23 [1] CRAN (R 4.5.1)
 codetools      0.2-20  2024-03-31 [2] CRAN (R 4.5.1)
 coin           1.4-3   2023-09-27 [1] CRAN (R 4.5.1)
 crosstalk      1.2.2   2025-08-26 [1] CRAN (R 4.5.1)
 data.table     1.17.8  2025-07-10 [1] CRAN (R 4.5.1)
 dataReporter * 1.0.5   2025-04-13 [1] CRAN (R 4.5.1)
 DEoptimR       1.1-4   2025-07-27 [1] CRAN (R 4.5.1)
 DescTools      0.99.60 2025-03-28 [1] CRAN (R 4.5.1)
 digest         0.6.37  2024-08-19 [1] CRAN (R 4.5.1)
 dplyr        * 1.1.4   2023-11-17 [1] CRAN (R 4.5.1)
 DT           * 0.34.0  2025-09-02 [1] CRAN (R 4.5.1)
 e1071          1.7-16  2024-09-16 [1] CRAN (R 4.5.1)
 evaluate       1.0.5   2025-08-27 [1] CRAN (R 4.5.1)
 Exact          3.3     2024-07-21 [1] CRAN (R 4.5.0)
 expm           1.0-0   2024-08-19 [1] CRAN (R 4.5.1)
 farver         2.1.2   2024-05-13 [1] CRAN (R 4.5.1)
 fastmap        1.2.0   2024-05-15 [1] CRAN (R 4.5.1)
 forcats      * 1.0.1   2025-09-25 [1] CRAN (R 4.5.1)
 foreach        1.5.2   2022-02-02 [1] CRAN (R 4.5.1)
 fs             1.6.6   2025-04-12 [1] CRAN (R 4.5.1)
 furrr          0.3.1   2022-08-15 [1] CRAN (R 4.5.1)
 future         1.67.0  2025-07-29 [1] CRAN (R 4.5.1)
 generics       0.1.4   2025-05-09 [1] CRAN (R 4.5.1)
 ggplot2      * 4.0.0   2025-09-11 [1] CRAN (R 4.5.1)
 gld            2.6.8   2025-09-14 [1] CRAN (R 4.5.1)
 glmnet         4.1-10  2025-07-17 [1] CRAN (R 4.5.1)
 globals        0.18.0  2025-05-08 [1] CRAN (R 4.5.0)
 glue           1.8.0   2024-09-30 [1] CRAN (R 4.5.1)
 gridExtra      2.3     2017-09-09 [1] CRAN (R 4.5.1)
 gtable         0.3.6   2024-10-25 [1] CRAN (R 4.5.1)
 haven          2.5.5   2025-05-30 [1] CRAN (R 4.5.1)
 here           1.0.2   2025-09-15 [1] CRAN (R 4.5.1)
 hms            1.1.3   2023-03-21 [1] CRAN (R 4.5.1)
 htmltools      0.5.8.1 2024-04-04 [1] CRAN (R 4.5.1)
 htmlwidgets    1.6.4   2023-12-06 [1] CRAN (R 4.5.1)
 httr           1.4.7   2023-08-15 [1] CRAN (R 4.5.1)
 iterators      1.0.14  2022-02-05 [1] CRAN (R 4.5.1)
 jomo           2.7-6   2023-04-15 [1] CRAN (R 4.5.1)
 jquerylib      0.1.4   2021-04-26 [1] CRAN (R 4.5.1)
 jsonlite       2.0.0   2025-03-27 [1] CRAN (R 4.5.1)
 knitr          1.50    2025-03-16 [1] CRAN (R 4.5.1)
 labeling       0.4.3   2023-08-29 [1] CRAN (R 4.5.0)
 labelled     * 2.15.0  2025-09-16 [1] CRAN (R 4.5.1)
 lattice        0.22-7  2025-04-02 [2] CRAN (R 4.5.1)
 libcoin        1.0-10  2023-09-27 [1] CRAN (R 4.5.1)
 lifecycle      1.0.4   2023-11-07 [1] CRAN (R 4.5.1)
 listenv        0.9.1   2024-01-29 [1] CRAN (R 4.5.1)
 lme4           1.1-37  2025-03-26 [1] CRAN (R 4.5.1)
 lmom           3.2     2024-09-30 [1] CRAN (R 4.5.0)
 lmtest         0.9-40  2022-03-21 [1] CRAN (R 4.5.1)
 lubridate    * 1.9.4   2024-12-08 [1] CRAN (R 4.5.1)
 magrittr       2.0.4   2025-09-12 [1] CRAN (R 4.5.1)
 MASS           7.3-65  2025-02-28 [2] CRAN (R 4.5.1)
 Matrix         1.7-3   2025-03-11 [2] CRAN (R 4.5.1)
 matrixStats    1.5.0   2025-01-07 [1] CRAN (R 4.5.1)
 mgcv           1.9-3   2025-04-04 [2] CRAN (R 4.5.1)
 mice         * 3.18.0  2025-05-27 [1] CRAN (R 4.5.1)
 minqa          1.2.8   2024-08-17 [1] CRAN (R 4.5.1)
 mitml          0.4-5   2023-03-08 [1] CRAN (R 4.5.1)
 mnormt         2.1.1   2022-09-26 [1] CRAN (R 4.5.0)
 modeltools     0.2-24  2025-05-02 [1] CRAN (R 4.5.0)
 multcomp       1.4-28  2025-01-29 [1] CRAN (R 4.5.1)
 multcompView   0.1-10  2024-03-08 [1] CRAN (R 4.5.1)
 mvtnorm        1.3-3   2025-01-10 [1] CRAN (R 4.5.1)
 naniar       * 1.1.0   2024-03-05 [1] CRAN (R 4.5.1)
 nlme           3.1-168 2025-03-31 [2] CRAN (R 4.5.1)
 nloptr         2.2.1   2025-03-17 [1] CRAN (R 4.5.1)
 nnet           7.3-20  2025-01-01 [2] CRAN (R 4.5.1)
 nortest        1.0-4   2015-07-30 [1] CRAN (R 4.5.0)
 pan            1.9     2023-08-21 [1] CRAN (R 4.5.1)
 pander       * 0.6.6   2025-03-01 [1] CRAN (R 4.5.1)
 parallelly     1.45.1  2025-07-24 [1] CRAN (R 4.5.1)
 patchwork    * 1.3.2   2025-08-25 [1] CRAN (R 4.5.1)
 pillar         1.11.1  2025-09-17 [1] CRAN (R 4.5.1)
 pkgconfig      2.0.3   2019-09-22 [1] CRAN (R 4.5.1)
 plyr           1.8.9   2023-10-02 [1] CRAN (R 4.5.1)
 proxy          0.4-27  2022-06-09 [1] CRAN (R 4.5.1)
 psych        * 2.5.6   2025-06-23 [1] CRAN (R 4.5.1)
 purrr        * 1.1.0   2025-07-10 [1] CRAN (R 4.5.1)
 R6             2.6.1   2025-02-15 [1] CRAN (R 4.5.1)
 rbibutils      2.3     2024-10-04 [1] CRAN (R 4.5.1)
 RColorBrewer   1.1-3   2022-04-03 [1] CRAN (R 4.5.0)
 rcompanion   * 2.5.0   2025-02-13 [1] CRAN (R 4.5.1)
 Rcpp           1.1.0   2025-07-02 [1] CRAN (R 4.5.1)
 Rdpack         2.6.4   2025-04-09 [1] CRAN (R 4.5.1)
 readr        * 2.1.5   2024-01-10 [1] CRAN (R 4.5.1)
 readxl         1.4.5   2025-03-07 [1] CRAN (R 4.5.1)
 reformulas     0.4.1   2025-04-30 [1] CRAN (R 4.5.1)
 rlang          1.1.6   2025-04-11 [1] CRAN (R 4.5.1)
 rmarkdown      2.29    2024-11-04 [1] CRAN (R 4.5.1)
 robustbase     0.99-6  2025-09-04 [1] CRAN (R 4.5.1)
 rootSolve      1.8.2.4 2023-09-21 [1] CRAN (R 4.5.0)
 rpart          4.1.24  2025-01-07 [2] CRAN (R 4.5.1)
 rprojroot      2.1.1   2025-08-26 [1] CRAN (R 4.5.1)
 rsample      * 1.3.1   2025-07-29 [1] CRAN (R 4.5.1)
 rstudioapi     0.17.1  2024-10-22 [1] CRAN (R 4.5.1)
 S7             0.2.0   2024-11-07 [1] CRAN (R 4.5.1)
 sandwich       3.1-1   2024-09-15 [1] CRAN (R 4.5.1)
 sass           0.4.10  2025-04-11 [1] CRAN (R 4.5.1)
 scales         1.4.0   2025-04-24 [1] CRAN (R 4.5.1)
 sessioninfo  * 1.2.3   2025-02-05 [1] CRAN (R 4.5.1)
 shape          1.4.6.1 2024-02-23 [1] CRAN (R 4.5.0)
 stringi        1.8.7   2025-03-27 [1] CRAN (R 4.5.0)
 stringr      * 1.5.2   2025-09-08 [1] CRAN (R 4.5.1)
 survival       3.8-3   2024-12-17 [2] CRAN (R 4.5.1)
 TH.data        1.1-4   2025-09-02 [1] CRAN (R 4.5.1)
 tibble       * 3.3.0   2025-06-08 [1] CRAN (R 4.5.1)
 tidyr        * 1.3.1   2024-01-24 [1] CRAN (R 4.5.1)
 tidyselect     1.2.1   2024-03-11 [1] CRAN (R 4.5.1)
 tidyverse    * 2.0.0   2023-02-22 [1] CRAN (R 4.5.1)
 timechange     0.3.0   2024-01-18 [1] CRAN (R 4.5.1)
 tzdb           0.5.0   2025-03-15 [1] CRAN (R 4.5.1)
 utf8           1.2.6   2025-06-08 [1] CRAN (R 4.5.1)
 vctrs          0.6.5   2023-12-01 [1] CRAN (R 4.5.1)
 visdat         0.6.0   2023-02-02 [1] CRAN (R 4.5.1)
 whoami         1.3.0   2019-03-19 [1] CRAN (R 4.5.1)
 withr          3.0.2   2024-10-28 [1] CRAN (R 4.5.1)
 xfun         * 0.53    2025-08-19 [1] CRAN (R 4.5.1)
 yaml           2.3.10  2024-07-26 [1] CRAN (R 4.5.0)
 zoo            1.8-14  2025-04-10 [1] CRAN (R 4.5.1)

 [1] C:/Users/User/AppData/Local/R/win-library/4.5
 [2] C:/Program Files/R/R-4.5.1/library
 * ── Packages attached to the search path.

──────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>